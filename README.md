# Active_losses_Swissgrid

## Overview
Swissgrid took part to a Machine Learning Hackaton with the goal of predicting the active losses for the grid. The originals notebooks can be found here [here](https://github.com/Swissgrid-AG-External/energydatahackdays23/tree/d5f88f3ff117ffcaafd43167e6357f7a5bfbc4a2/group3). The results were very impressive and many stakeholders were keen to see the results on internal data instead of old open data.

This repository corresponds to a proposal of solution for the ML Engineer Challenge that can be found [here](https://github.com/Swissgrid-AG-External/coding_challenges/blob/main/ml_engineer/intern/README.md). The 3 main goals of this challenge are the followings:
1. write a markdown file (Approach.md) to describe the approach taken
2. Refactor the notebooks into clean, well-organized pyhton file while preserving existing functionnalities. The primary goal was to enhance code structure, readability, and maintainability.
3. Change or add 1 or 2 functions to the script

The proposed solution offers a more understandable and easy to use code that achieves the following:
- loading of the data 
- preprocessing of the data and addition of useful features (time, date, holidays, cyclical_features, lag features)
- finetuning ElasticNet model 
- training of the model and visualization of predictions over test data 
- training model on entire dataset with best hyperparameters and saving it for later use

## Installation
Python 3.11.5 was used for this project
- conda env create -f environment.yaml
- conda activate active_loss

## Structure of the code
```
├── README.md
├── Approach.md
├── notebooks
│   ├── 0_Data Preprocessing Base.ipynb
│   └── 2_ElasticNet.ipynb
├── data
│   ├── processed
│   │   └── df_preprocessed.csv
│   └── raw
│       ├── Active-Losses.csv
│       ├── NTC.csv
│       ├── data_explanation.md
│       ├── eq_renewables.csv
│       └── eq_temp.csv
├── main.py
├── src
│   ├── __init__.py
│   ├── parameter_tuning.py
│   ├── pipeline.py
│   ├── preprocessing.py
│   ├── training.py
│   ├── util.py
│   └── visualization.py
├── plots
├── saved_models
└── environment.yml
```

## Stucture of the data folder
For more details on the raw data refer to [data_explanation.md](https://github.com/yanis-trn/Active_losses_Swissgrid/blob/main/data/raw/data_explanation.md). For more details on how the preprocessed data is obtained refer to the preprocessing.py file.
```
├── data
│   ├── processed
│   │   └── df_preprocessed.csv     <- generated by the code after preprocessing and feature engineering 
│   └── raw
│       ├── data_explanation.md     
│       ├── Active-Losses.csv       <- historical active losses data, unit: kWh per 15 minutes
│       ├── NTC.csv                 <- net transfer capacity between two areas
│       ├── eq_renewables.csv       <- forecast-renewable-generation (unit: MW)
│       └── eq_temp.csv             <- forecast temperature (unit: °C)
```

## Additionnal visualization of the forecasting quality
In order for different stakeholders to realize and assess the quality of the forecasting an additionnal function (visualize_model_predictions) was added. It allows to easily save plots of the predictions from the ElasticNet model with the best hyperparameters. Such a plot is represented below:
![Example plot](plots/line_plot_3.png)
